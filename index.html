---
layout: default
title: Population Distribution
---

<div class="chart-container">
  <canvas id="districtChart"></canvas>
</div>

<div class="chart-container">
  <canvas id="subdistrictChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Get data from Jekyll
  const districts = {% raw %}{{ site.data.population | jsonify }}{% endraw %};

  // Prepare data for District chart
  const districtLabels = districts.map(d => d.name);
  const districtData = districts.map(d => d.population);
  const districtColors = generateColors(districts.length, 0.7);

  // Create District chart
  const districtCtx = document.getElementById('districtChart').getContext('2d');
  new Chart(districtCtx, {
    type: 'bar',
    data: {
      labels: districtLabels,
      datasets: [{
        label: 'Population by District',
        data: districtData,
        backgroundColor: districtColors,
        borderColor: districtColors.map(c => c.replace('0.7', '1')),
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      plugins: {
        title: {
          display: true,
          text: 'Population by District',
          font: { size: 18 }
        },
        tooltip: {
          callbacks: {
            label: function(context) {
              return `${context.parsed.y.toLocaleString()} people`;
          }
        }
      }
    },
    scales: {
      y: {
        beginAtZero: true,
        ticks: {
          callback: function(value) {
            return value.toLocaleString();
          }
        }
      }
    }
  });

  // Prepare data for Subdistrict chart (top 15 most populous)
  const allSubdistricts = [];
  districts.forEach(district => {
    district.subdistricts.forEach(sub => {
      allSubdistricts.push({
        name: `${sub.name} (${district.name})`,
        population: sub.population
      });
    });
  });

  // Sort and get top 15
  const topSubdistricts = allSubdistricts.sort((a, b) => b.population - a.population).slice(0, 15);
  const subdistrictLabels = topSubdistricts.map(s => s.name);
  const subdistrictData = topSubdistricts.map(s => s.population);
  const subdistrictColors = generateColors(topSubdistricts.length, 0.6);

  // Create Subdistrict chart
  const subdistrictCtx = document.getElementById('subdistrictChart').getContext('2d');
  new Chart(subdistrictCtx, {
    type: 'bar',
    data: {
      labels: subdistrictLabels,
      datasets: [{
        label: 'Population',
        data: subdistrictData,
        backgroundColor: subdistrictColors,
        borderColor: subdistrictColors.map(c => c.replace('0.6', '1')),
        borderWidth: 1
      }]
    },
    options: {
      indexAxis: 'y', // Horizontal bars
      responsive: true,
      plugins: {
        title: {
          display: true,
          text: 'Top 15 Most Populous Subdistricts',
          font: { size: 18 }
        },
        tooltip: {
          callbacks: {
            label: function(context) {
              return `${context.parsed.x.toLocaleString()} people`;
            }
          }
        }
      },
      scales: {
        x: {
          beginAtZero: true,
          ticks: {
            callback: function(value) {
              return value.toLocaleString();
            }
          }
        }
      }
    }
  });

  // Helper function to generate colors
  function generateColors(count, opacity) {
    const colors = [];
    const hueStep = 360 / count;
    for (let i = 0; i < count; i++) {
      const hue = i * hueStep;
      colors.push(`hsla(${hue}, 70%, 60%, ${opacity})`);
    }
    return colors;
  }
});
</script>

<style>
.chart-container {
  position: relative;
  height: 500px;
  margin-bottom: 3rem;
}

@media (max-width: 768px) {
  .chart-container {
    height: 300px;
  }
}
</style>
